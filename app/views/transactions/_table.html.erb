<div class="relative mt-6 space-y-4 rounded-3xl border-2 border-black bg-[#fdebd0] p-5 shadow-[12px_12px_0_#000]">
  <div class="flex flex-wrap items-center justify-between gap-3">
    <div>
      <p class="text-xs font-semibold uppercase tracking-[0.25em] text-slate-500">Results</p>
      <p class="text-sm text-slate-600">Showing <%= transactions.size %> matching entries</p>
    </div>
    <div class="rounded-full border-2 border-black bg-white px-3 py-1 text-xs font-semibold uppercase tracking-wider text-slate-600 shadow-[0_3px_0_#000]">
      Live sync
    </div>
  </div>

  <div class="overflow-x-auto rounded-2xl border-2 border-black bg-white">
    <table class="min-w-full text-sm text-slate-800">
      <thead class="bg-slate-900 text-slate-100 text-left text-xs font-semibold uppercase tracking-[0.25em]">
        <tr>
          <th class="px-5 py-4">Details</th>
          <th class="px-5 py-4">Amount</th>
          <th class="px-5 py-4">Category</th>
          <th class="px-5 py-4">Email</th>
          <th class="px-5 py-4 text-right">Action</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-slate-200">
        <% transactions.each do |t| %>
          <% merchant = t.merchant.presence || "Unknown merchant" %>
          <% category = t.category_display %>
          <% date = t.transaction_date || t.created_at.to_date %>
          <% relative = time_ago_in_words(t.created_at) %>
          <tr class="group transition hover:bg-[#fff6eb]">
            <td class="px-5 py-4 align-top">
              <div class="font-semibold text-slate-900"><%= merchant %></div>
              <%= render "transactions/category_label", transaction: t %>
              <p class="mt-2 text-xs text-slate-500">
                <%= date %> • <%= relative %> ago
              </p>
            </td>
            <td class="px-5 py-4 align-top">
              <p class="text-lg font-black text-slate-900"><%= transaction_amount_display(t) %></p>
              <p class="text-xs text-slate-500">Captured in <%= t.currency.presence || "₹" %></p>
            </td>
            <td class="px-5 py-4 align-top">
              <%= render "transactions/category_editor", transaction: t %>
            </td>
            <td class="px-5 py-4 align-top">
              <% if t.email.present? %>
                <p class="font-semibold text-slate-900"><%= t.email.subject.presence || "(no subject)" %></p>
                <%= link_to "Open email",
                    email_path(t.email),
                    class: "mt-1 inline-flex items-center gap-1 text-xs font-semibold text-blue-700 underline decoration-2",
                    data: { turbo_frame: "_top" } %>
              <% else %>
                <p class="text-sm text-slate-500">Not linked</p>
                <p class="text-xs text-slate-400">Attach an email to see the context.</p>
              <% end %>
            </td>
            <td class="px-5 py-4 align-top text-right">
              <%= link_to transaction_path(t),
                  class: "inline-flex items-center gap-2 rounded-2xl border-2 border-black bg-amber-300 px-4 py-2 text-xs font-semibold uppercase tracking-wide text-slate-900 shadow-[0_4px_0_#000] transition hover:-translate-y-0.5",
                  data: { turbo_frame: "_top" } do %>
                View
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
                </svg>
              <% end %>
            </td>
          </tr>
        <% end %>
        <% if transactions.blank? %>
          <tr>
            <td colspan="5" class="px-6 py-10 text-center">
              <div class="rounded-2xl border-2 border-dashed border-slate-300 bg-slate-50 px-6 py-8">
                <p class="text-lg font-semibold text-slate-700">Nothing to see yet</p>
                <p class="mt-1 text-sm text-slate-500">Once new receipts sync from your inbox, they will materialize here automatically.</p>
              </div>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>